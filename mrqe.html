<html>
<head>
<title>Marquee</title>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="mrqe.js"></script>
</head>
<body>

<section id="test1">
  <span style="white-space: nowrap;">start 
    <span id="t1loop0">hi</span>
    <span id="t1loop1" style="display: none">test test test test test test test test test test test test test test test test test test test test test test test test test test</span>
    <span id="t1loop2" style="display: none"><a href="https://www.google.com" target="google">Google</a></span>
    <span id="t1loop3" style="display: none">test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2</span>
  end</span>
</section>

<section id="test2">
  <span style="white-space: nowrap;">start 
    <span id="t2loop0">hi</span>
    <span id="t2loop1" style="display: none">test test test test test test test test test test test test test test test test test test test test test test test test test test</span>
    <span id="t2loop2" style="display: none"><a href="https://www.google.com" target="google">Google</a></span>
    <span id="t2loop3" style="display: none">test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2</span>
  end</span>
</section>

<section id="test3">
  <span style="white-space: nowrap;">start 
    <span id="t3loop0">hi</span>
    <span id="t3loop1" style="display: none">test test test test test test test test test test test test test test test test test test test test test test test test test test</span>
    <span id="t3loop2" style="display: none"><a href="https://www.google.com" target="google">Google</a></span>
    <span id="t3loop3" style="display: none">test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2 test2</span>
  end</span>
</section>

<script type="text/javascript">
<!--

(function($) {
    var totalitems = 4;

    var loopcount1 = 0;
    var mrq1 = new mrqe("section#test1", {
        loop: () => {
            // loopcount iterates & repeats
            loopcount1++;
            if (loopcount1>=totalitems) loopcount1 = 0;
              
            // each display element (#loop)
            for (var i=0; i < totalitems; i++) {
                $('#t1loop' + i).toggle(loopcount1==i); // set off for all except loopcount (on)
            }
        }
    });
    $("section#test1")
        .mouseover(function () {
            // pause on mouse over
             mrq1.pause(true);
        })
        .mouseout(function () {
            // unpause on mouse leave
            mrq1.pause(false);
        });

    var loopcount2 = 0;
    var mrq2 = new mrqe("section#test2", {
        loop: () => {
            // loopcount iterates & repeats
            loopcount2++;
            if (loopcount2>=totalitems) loopcount2 = 0;
              
            // each display element (#loop)
            for (var i=0; i < totalitems; i++) {
                $('#t2loop' + i).toggle(loopcount2==i); // set off for all except loopcount (on)
            }
        },
        leftToRight: true
    });
    var speed = 1;
    var timer = null;
    var haywire = true;
    function slowdownTest2(newspeed=false) {
        if (newspeed!==false) speed = newspeed;
        mrq2.speed(speed);
        if (timer) window.clearTimeout(timer);
        timer = window.setTimeout(function(){
            if (speed>0.00001) slowdownTest2();
        }, 10);
        speed /= 1.05;
    }
    function speedupTest2(newspeed=false) {
        if (newspeed!==false) speed = newspeed;
        mrq2.speed(speed);
        if (timer) window.clearTimeout(timer);
        timer = window.setTimeout(function(){
            if ((haywire && speed<1000) || (!haywire && speed<1)) speedupTest2();
        }, 10);
        speed *= 1.05;
    }
    $("section#test2")
        .mouseover(function () {
            if (timer) window.clearTimeout(timer);
            slowdownTest2();
        })
        .mouseout(function () {
            if (timer) window.clearTimeout(timer);
            haywire = !haywire;
            console.log(haywire?'https://www.youtube.com/watch?v=ygE01sOhzz0':'Cut the chatter, Red Two. Accelerate to attack speed');
            speedupTest2(speed);
        });
        
    var loopcount3 = 0;
    var mrq3 = new mrqe("section#test3", {
        loop: () => {
            // loopcount iterates & repeats
            loopcount3++;
            if (loopcount3>=totalitems) loopcount3 = 0;
              
            // each display element (#loop)
            for (var i=0; i < totalitems; i++) {
                $('#t3loop' + i).toggle(loopcount3==i); // set off for all except loopcount (on)
            }
        },
        end: function () {
            console.log('Restarting Test 3 in 5 seconds');
            window.setTimeout(function () {
                loopcount3 = -1;
                mrq3.reload();
                mrq3.start();
                console.log('Test 3 restarted.');
            }, 5000);
        },
        count: 4
    });
    $("section#test3")
        .mouseover(function () {
            // pause on mouse over
             mrq3.pause(true);
        })
        .mouseout(function () {
            // unpause on mouse leave
            mrq3.pause(false);
        });
    
    $('window').on('resize', function() {
        mrq1.reloadWidth();
        mrq2.reloadWidth();
        mrq3.reloadWidth();
    });
        
})(jQuery);

// -->
</script>

</body>
